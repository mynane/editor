!! do not rely on dom state, e.g. window.getSelection() !!

rule of thumb: don't use refs
